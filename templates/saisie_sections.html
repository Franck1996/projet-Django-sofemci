{% extends 'base.html' %}
{% load static %}

{% block title %}Saisie Sections - SOFEM-CI{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>üè≠ Saisie Production - Autres Sections</h1>
        <p>Saisie des donn√©es de production pour Imprimerie, Soudure et Recyclage</p>
    </div>

    <!-- Navigation entre sections -->
    <div class="section-tabs">
        <button class="tab-btn active" data-tab="imprimerie">üñ®Ô∏è Imprimerie</button>
        <button class="tab-btn" data-tab="soudure">üîå Soudure</button>
        <button class="tab-btn" data-tab="recyclage">‚ôªÔ∏è Recyclage</button>
    </div>

    <!-- Formulaire Imprimerie -->
    <form method="post" class="production-form tab-content active" id="imprimerie-form">
        {% csrf_token %}
        <input type="hidden" name="section" value="imprimerie">
        
        <div class="form-section">
            <h2>Production Imprimerie</h2>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="imprimerie_date">Date</label>
                    <input type="date" id="imprimerie_date" name="date_production" 
                           value="{{ today|date:'Y-m-d' }}" required class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="imprimerie_machines">Machines actives</label>
                    <input type="number" id="imprimerie_machines" name="nombre_machines_actives" 
                           min="0" max="10" required class="form-control">
                </div>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="imprimerie_debut">Heure d√©but</label>
                    <input type="time" id="imprimerie_debut" name="heure_debut" required class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="imprimerie_fin">Heure fin</label>
                    <input type="time" id="imprimerie_fin" name="heure_fin" required class="form-control">
                </div>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="imprimerie_finis">Bobines finies (kg)</label>
                    <input type="number" id="imprimerie_finis" name="production_bobines_finies_kg" 
                           step="0.01" min="0" required class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="imprimerie_semi">Bobines semi-finies (kg)</label>
                    <input type="number" id="imprimerie_semi" name="production_bobines_semi_finies_kg" 
                           step="0.01" min="0" required class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="imprimerie_dechets">D√©chets (kg)</label>
                    <input type="number" id="imprimerie_dechets" name="dechets_kg" 
                           step="0.01" min="0" required class="form-control">
                </div>
            </div>
            
            <div class="form-group">
                <label for="imprimerie_observations">Observations</label>
                <textarea id="imprimerie_observations" name="observations" rows="3" class="form-control"></textarea>
            </div>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn-primary">üíæ Enregistrer Imprimerie</button>
        </div>
    </form>

    <!-- Formulaire Soudure -->
    <form method="post" class="production-form tab-content" id="soudure-form">
        {% csrf_token %}
        <input type="hidden" name="section" value="soudure">
        
        <div class="form-section">
            <h2>Production Soudure</h2>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="soudure_date">Date</label>
                    <input type="date" id="soudure_date" name="date_production" 
                           value="{{ today|date:'Y-m-d' }}" required class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="soudure_machines">Machines actives</label>
                    <input type="number" id="soudure_machines" name="nombre_machines_actives" 
                           min="0" max="8" required class="form-control">
                </div>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="soudure_debut">Heure d√©but</label>
                    <input type="time" id="soudure_debut" name="heure_debut" required class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="soudure_fin">Heure fin</label>
                    <input type="time" id="soudure_fin" name="heure_fin" required class="form-control">
                </div>
            </div>
            
            <h3>Production Standard</h3>
            <div class="form-group">
                <label for="soudure_finis">Bobines finies (kg)</label>
                <input type="number" id="soudure_finis" name="production_bobines_finies_kg" 
                       step="0.01" min="0" required class="form-control">
            </div>
            
            <h3>Production Sp√©cifique</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="soudure_bretelles">Bretelles (kg)</label>
                    <input type="number" id="soudure_bretelles" name="production_bretelles_kg" 
                           step="0.01" min="0" class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="soudure_rema">REMA-Plastique (kg)</label>
                    <input type="number" id="soudure_rema" name="production_rema_kg" 
                           step="0.01" min="0" class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="soudure_batta">BATTA (kg)</label>
                    <input type="number" id="soudure_batta" name="production_batta_kg" 
                           step="0.01" min="0" class="form-control">
                </div>
            </div>
            
            <div class="form-group">
                <label for="soudure_dechets">D√©chets (kg)</label>
                <input type="number" id="soudure_dechets" name="dechets_kg" 
                       step="0.01" min="0" required class="form-control">
            </div>
            
            <div class="form-group">
                <label for="soudure_observations">Observations</label>
                <textarea id="soudure_observations" name="observations" rows="3" class="form-control"></textarea>
            </div>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn-primary">üíæ Enregistrer Soudure</button>
        </div>
    </form>

    <!-- Formulaire Recyclage -->
    <form method="post" class="production-form tab-content" id="recyclage-form">
        {% csrf_token %}
        <input type="hidden" name="section" value="recyclage">
        
        <div class="form-section">
            <h2>Production Recyclage</h2>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="recyclage_date">Date</label>
                    <input type="date" id="recyclage_date" name="date_production" 
                           value="{{ today|date:'Y-m-d' }}" required class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="recyclage_equipe">√âquipe</label>
                    <select id="recyclage_equipe" name="equipe" required class="form-control">
                        <option value="">S√©lectionnez l'√©quipe</option>
                        {% for equipe in equipes %}
                        <option value="{{ equipe.id }}">{{ equipe.get_nom_display }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="recyclage_moulinex">Nombre de moulinex</label>
                    <input type="number" id="recyclage_moulinex" name="nombre_moulinex" 
                           min="0" max="5" required class="form-control">
                </div>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="recyclage_broyage">Production broyage (kg)</label>
                    <input type="number" id="recyclage_broyage" name="production_broyage_kg" 
                           step="0.01" min="0" required class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="recyclage_bache">B√¢che noire (kg)</label>
                    <input type="number" id="recyclage_bache" name="production_bache_noir_kg" 
                           step="0.01" min="0" required class="form-control">
                </div>
            </div>
            
            <div class="form-group">
                <label for="recyclage_observations">Observations</label>
                <textarea id="recyclage_observations" name="observations" rows="3" class="form-control"></textarea>
            </div>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn-primary">üíæ Enregistrer Recyclage</button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Navigation par onglets
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        // D√©sactiver tous les onglets
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        // Activer l'onglet courant
        this.classList.add('active');
        const tabId = this.getAttribute('data-tab');
        document.getElementById(tabId + '-form').classList.add('active');
    });
});
</script>
{% endblock %}